【3.1:Springによるデータアクセス】

【3.1.2:データソースのコンフィギュレーション】

・(2018.04.23、2018.08.25)アプリケーション定義のデータソース（Java-config）

　pom.xml:
　
  <groupId>example.datasource</groupId>
  <artifactId>postgres</artifactId>
	・・・
  <dependencies>
        <!-- @Bean, @Configuration, etc. -->
  		<dependency>
			<groupId>org.springframework</groupId>
			<artifactId>spring-context</artifactId>
		</dependency>

  		<dependency>
			<groupId>org.springframework</groupId>
			<artifactId>spring-jdbc</artifactId>
		</dependency>

		<!--  org.apache.commons.dbcp2.BasicDataSource -->
		<dependency>
		    <groupId>org.apache.commons</groupId>
		    <artifactId>commons-dbcp2</artifactId>
		</dependency>

        <dependency>
            <groupId>org.postgresql</groupId>
            <artifactId>postgresql</artifactId>
        </dependency>

  </dependencies>

　Postgresデータベース設定：
　
　	データベース：sample
　	ユーザ名：demo
　	パスワード：demo

　参照：　https://docs.oracle.com/javase/jp/8/docs/api/javax/sql/DataSource.html


・(2018.04.23、2018.08.25)アプリケーション定義のデータソース（XML-config）

  <groupId>example.datasource</groupId>
  <artifactId>postgres-xml</artifactId>
　
　ベース：postgres
　
　
・（2018.04.15、2018.08.25）組み込みデータソース（Java-config)

　pom.xml:
　
  <groupId>example.datasource</groupId>
  <artifactId>embedded-db</artifactId>
	・・・
  <dependencies>
  		<dependency>
			<groupId>org.springframework</groupId>
			<artifactId>spring-context</artifactId>
		</dependency>

		<!-- org.springframework.jdbc.datasource.embedded.EmbeddedDatabase, etc. -->
  		<dependency>
			<groupId>org.springframework</groupId>
			<artifactId>spring-jdbc</artifactId>
		</dependency>

		<!-- org.h2.Driver -->
 		<dependency>
			<groupId>com.h2database</groupId>
			<artifactId>h2</artifactId>
		</dependency>
  </dependencies>
	

・（2018.04.15、2018.08.25）組み込みデータソース（XML-config)

  <groupId>example.datasource</groupId>
  <artifactId>embedded-db-xml</artifactId>

　ベース：embedded-db


【3.2:Spring　JDBC】

【3.2.2:JdbcTemplateクラスを利用したCRUD操作】

・（2018.04.15、2018.08.25）JdbcTemplateを使用したデータアクセス(H2)

　pom.xml：
　
  <groupId>example.jdbc</groupId>
  <artifactId>jdbctemplate</artifactId>
	・・・
  <dependencies>
  		<dependency>
			<groupId>org.springframework</groupId>
			<artifactId>spring-context</artifactId>
		</dependency>

		<!-- org.springframework.jdbc.core.JdbcTemplate, etc. -->
  		<dependency>
			<groupId>org.springframework</groupId>
			<artifactId>spring-jdbc</artifactId>
		</dependency>

		<!-- org.h2.Driver, etc. -->
 		<dependency>
			<groupId>com.h2database</groupId>
			<artifactId>h2</artifactId>
		</dependency>
  </dependencies>

　H2のテーブル：

　schema.sql:
	CREATE TABLE user (
  	user_id         INTEGER PRIMARY KEY,
  	user_name VARCHAR(30),
  	email  VARCHAR(50)
　	);
　	
　insert-nit-data.sql:
	INSERT INTO user VALUES (1, 'mkyong', 'mkyong@gmail.com');
	INSERT INTO user VALUES (2, 'alex', 'alex@yahoo.com');
	INSERT INTO user VALUES (3, 'joel', 'joel@gmail.com');


・（2018.04.23、2018.08.25）JdbcTemplateを使用したデータアクセス（PostgreSQL）

　pom.xml:
　
  <groupId>example.jdbc</groupId>
  <artifactId>jdbctemplate-pg</artifactId>
	・・・
  <dependencies>
  		<dependency>
			<groupId>org.springframework</groupId>
			<artifactId>spring-context</artifactId>
		</dependency>
		
		<!-- org.springframework.jdbc.core.JdbcTemplate, etc. -->
  		<dependency>
			<groupId>org.springframework</groupId>
			<artifactId>spring-jdbc</artifactId>
		</dependency>

		<!-- org.apache.commons.dbcp2.BasicDataSource -->
		<dependency>
		    <groupId>org.apache.commons</groupId>
		    <artifactId>commons-dbcp2</artifactId>
		</dependency>		

		<!-- org.postgresql.Driver -->
        <dependency>
            <groupId>org.postgresql</groupId>
            <artifactId>postgresql</artifactId>
        </dependency>
  </dependencies>


　PostgreSQL設定：
　
　	データベース：sample
　	テーブル：user_table
　	ユーザ名：demo
　	パスワード：demo

　PostgreSQLでの確認：

	C:\Users\sasaki>psql -U demo sample
	ユーザー demo のパスワード:
	psql (10.3)

	sample=> \dt
	             リレーション一覧
	 スキーマ |    名前    |    型    | 所有者
	----------+------------+----------+--------
	 public   | equipment  | テーブル | demo
	 public   | room       | テーブル | demo
	 public   | user_table | テーブル | demo
	(3 行)


	sample=> select * from user_table;
	 user_id | user_name |      email
	---------+-----------+------------------
	 1       | mkyong    | mkyong@gmail.com
	 2       | alex      | alex@yahoo.com
	 3       | joel      | joel@gmail.com
	(3 行)


・（2018.04.15）Java標準データ型による1項目の取得

  <groupId>example.jdbc</groupId>
  <artifactId>queryforobject</artifactId>

　(データベース設定)
　	データベース：sample
　	テーブル：room, equipment
　	ユーザ名：demo
　	パスワード：demo

・（2018.04.24）Java標準データ型による1項目の取得(PostgreSQL)

  <groupId>example.jdbc</groupId>
  <artifactId>queryforobject-pg</artifactId>


・（2018.04.15）バインド変数を利用したSQL

  <groupId>example.jdbc</groupId>
  <artifactId>bindparam</artifactId>

・（2018.04.25）バインド変数を利用したSQL(PostgreSQL)

  <groupId>example.jdbc</groupId>
  <artifactId>bindparam-pg</artifactId>


・（2018.04.15）名前付きバインド変数を利用したSQL

  <groupId>example.jdbc</groupId>
  <artifactId>named-bindparam</artifactId>

・（2018.04.25）名前付きバインド変数を利用したSQL(PostgreSQL)

  <groupId>example.jdbc</groupId>
  <artifactId>named-bindparam-pg</artifactId>

・（2018.04.15）MapSqlParameterSource

  <groupId>example.jdbc</groupId>
  <artifactId>mapsqlparametersource</artifactId>

・（2018.04.25）MapSqlParameterSource(PostgreSQL)

  <groupId>example.jdbc</groupId>
  <artifactId>mapsqlparametersource-pg</artifactId>

・（2018.04.15）BeanPropertySqlParameterSource

  <groupId>example.jdbc</groupId>
  <artifactId>beanpropertysqlparametersource</artifactId>

・（2018.04.25）BeanPropertySqlParameterSource(PostgreSQL)

  <groupId>example.jdbc</groupId>
  <artifactId>beanpropertysqlparametersource-pg</artifactId>

・（2018.04.15）1行の検索結果を取得

  <groupId>example.jdbc</groupId>
  <artifactId>queryformap</artifactId>

・（2018.04.25）1行の検索結果を取得(PostgreSQL)

  <groupId>example.jdbc</groupId>
  <artifactId>queryformap-pg</artifactId>

・（2018.04.15）複数行の検索結果を取得

  <groupId>example.jdbc</groupId>
  <artifactId>queryforlist</artifactId>

・（2018.04.25）複数行の検索結果を取得

  <groupId>example.jdbc</groupId>
  <artifactId>queryforlist-pg</artifactId>

・（2018.04.16）テーブルを更新する処理

  <groupId>example.jdbc</groupId>
  <artifactId>update</artifactId>

・（2018.04.26）テーブルを更新する処理(PostgreSQL)

  <groupId>example.jdbc</groupId>
  <artifactId>update-pg</artifactId>

　(コメント）
　	INSERT/UPDATE/DELETEを完了させるために、トランザクションをコミットさせなければならない
　	
【3.2.3:取得結果の変換処理】

・（2018.04.17）RowMapperの実装

  <groupId>example.jdbc</groupId>
  <artifactId>rowmapper</artifactId>

・（2018.04.26）RowMapperの実装

  <groupId>example.jdbc</groupId>
  <artifactId>rowmapper-pg</artifactId>

・（2018.04.17）ラムダ式を利用したRowMapperの実装

  <groupId>example.jdbc</groupId>
  <artifactId>rowmapper-lambda</artifactId>

・（2018.04.26）ラムダ式を利用したRowMapperの実装（postgreSQL）

  <groupId>example.jdbc</groupId>
  <artifactId>rowmapper-lambda-pg</artifactId>

・（2018.04.17）BeanPropertyRowMapperを利用したDaoクラスの実装

  <groupId>example.jdbc</groupId>
  <artifactId>beanpropertyrowmapper</artifactId>

・（2018.04.27）BeanPropertyRowMapperを利用したDaoクラスの実装(PostgreSQL)

  <groupId>example.jdbc</groupId>
  <artifactId>beanpropertyrowmapper-pg</artifactId>

・（2018.04.17）ResultSetExtractor

  <groupId>example.jdbc</groupId>
  <artifactId>resultsetextractor</artifactId>

・（2018.04.27）ResultSetExtractor(PostgreSQL)

  <groupId>example.jdbc</groupId>
  <artifactId>resultsetextractor-pg</artifactId>


・（2018.04.18）RowCallbackHandler

  <groupId>example.jdbc</groupId>
  <artifactId>rowcallbackhandler</artifactId>

・（2018.04.27）RowCallbackHandler(PostgreSQL)

  <groupId>example.jdbc</groupId>
  <artifactId>rowcallbackhandler-pg</artifactId>


【3.3:トランザクション管理】

【3.3.2:宣言的トランザクション】

・（2018.04.21, 2018.04.22）＠Transactionを利用した宣言的トランザクション

  <groupId>example.transaction</groupId>
  <artifactId>transactional</artifactId>

・（2018.04.28）＠Transactionを利用した宣言的トランザクション(PostgreSQL)

  <groupId>example.transaction</groupId>
  <artifactId>transactional-pg</artifactId>

・（2018.04.21、2018.04.22）XMLコンフィギュレーションによる宣言的トランザクション

  <groupId>example.transaction</groupId>
  <artifactId>xml-config</artifactId>

・（2018.04.28）XMLコンフィギュレーションによる宣言的トランザクション(PostgreSQL)

  <groupId>example.transaction</groupId>
  <artifactId>xml-config-pg</artifactId>


【3.3.3:明示的トランザクション】

・（2018.04.21、2018.04.22）PlatformTransactionManagerを利用した明示的トランザクション制御

  <groupId>example.transaction</groupId>
  <artifactId>platformtransactionmanager</artifactId>

・（2018.04.28）PlatformTransactionManagerを利用した明示的トランザクション制御(PostgreSQL)

  <groupId>example.transaction</groupId>
  <artifactId>platformtransactionmanager-pg</artifactId>

・（2018.04.21、2018.04.22）TransactionTemplateを利用した明示的トランザクション制御

  <groupId>example.transaction</groupId>
  <artifactId>transactiontemplate</artifactId>

・（2018.04.28）TransactionTemplateを利用した明示的トランザクション制御(PostgreSQL)

  <groupId>example.transaction</groupId>
  <artifactId>transactiontemplate-pg</artifactId>

【3.4:データアクセスエラーのハンドリング】

【3.4.2:データアクセス例外のハンドリング】

・(2018.04.22)データアクセス例外のハンドリング例

  <groupId>example.dataaccessexception</groupId>
  <artifactId>handle-exception</artifactId>

・(2018.04.28)データアクセス例外のハンドリング例(PostgreSQL)

  <groupId>example.dataaccessexception</groupId>
  <artifactId>handle-exception-pg</artifactId>

【3.4.3:データアクセス例外の変換ルールのカスタマイズ】

・(2018.04.22)H2データベースのエラーコードのカスタマイズ

  <groupId>example.dataaccessexception</groupId>
  <artifactId>custom-error-codes</artifactId>

